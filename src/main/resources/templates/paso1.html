<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Carrito de compras</title>
    <style>
        body { font-family: monospace; background:#111; color:#eee; }
        .box { border:1px solid #666; padding:10px; margin:20px; }
        .center { text-align:center; }
        .right { text-align:right; }
        .mt { margin-top:10px; }
        input[type="text"], input[type="number"] {
            background:#000; border:1px solid #666; color:#eee; padding:2px 4px;
        }
        button { background:#333; color:#eee; border:1px solid #666; padding:3px 8px; }
        button:hover { background:#555; cursor:pointer; }
        table { width:100%; border-collapse:collapse; }
        td, th { padding:2px 4px; }
        hr { border:0; border-top:1px dashed #666; }
    </style>
</head>
<body>

<div class="box">
    <pre>ASCII art of the Cart</pre>
    <hr>

    <!-- Paso / título -->
    <div>| Step 1 of 3 - Shopping Cart |</div>
    <hr>

    <!-- Productos en el carrito -->
    <div>| Products in your cart |</div>
    <hr>

    <table>
        <thead>
        <tr>
            <th>Name</th>
            <th class="right">Unit price</th>
            <th class="center">Quantity</th>
            <th class="right">Subtotal</th>
            <th class="center">Actions</th>
        </tr>
        </thead>
        <tbody>
        <!-- items viene de tu modelo: List<CartItem> -->
        <tr th:each="item : ${items}">
            <td th:text="${item.name}">Bluetooth Headphones</td>
            <td class="right" th:text="${item.unitPrice} + ' €'">25.00 €</td>
            <td class="center" th:text="${item.quantity}">2</td>
            <td class="right" th:text="${item.subtotal} + ' €'">50.00 €</td>
            <td class="center">
                <form th:action="@{/cart/decrease}" method="post" style="display:inline">
                    <input type="hidden" name="id" th:value="${item.id}">
                    <button type="submit">[ - ]</button>
                </form>
                <form th:action="@{/cart/increase}" method="post" style="display:inline">
                    <input type="hidden" name="id" th:value="${item.id}">
                    <button type="submit">[ + ]</button>
                </form>
                <form th:action="@{/cart/remove}" method="post" style="display:inline">
                    <input type="hidden" name="id" th:value="${item.id}">
                    <button type="submit">[ X ]</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>

    <hr>

    <!-- Añadir nuevo producto -->
    <div>| Add new product: |</div>
    <form th:action="@{/cart/add}" method="post">
        <div>
            Name: [ <input type="text" name="name" size="20"> ]
            Price: [ <input type="number" name="price" step="0.01" style="width:80px"> ]
            Qty: [ <input type="number" name="quantity" min="1" value="1" style="width:50px"> ]
            <button type="submit">[ Add ]</button>
        </div>
    </form>

    <hr>

    <!-- Cupón de descuento -->
    <form th:action="@{/cart/apply-coupon}" method="post" class="mt">
        Discount coupon:
        [ <input type="text" name="code" th:value="${appliedCoupon != null} ? ${appliedCoupon.code} : ''"> ]
        <button type="submit">[ Apply ]</button>
    </form>

    <div th:if="${appliedCoupon != null}">
        Applied coupon: <span th:text="${appliedCoupon.code}">DISCOUNT10</span>
        - <span th:text="${appliedCoupon.amount} + ' €'">-10.00 €</span>
    </div>

    <hr>

    <!-- Totales -->
    <div class="right">
        Gross total: <span th:text="${grossTotal} + ' €'">58.00 €</span><br>
        Coupon discount: <span th:text="${discount} + ' €'">-10.00 €</span><br>
        <strong>Total to pay: <span th:text="${totalToPay} + ' €'">48.00 €</span></strong>
    </div>

    <hr>

    <!-- Continuar -->
    <div class="center mt">
        <form th:action="@{/checkout/step2}" method="get">
            <button type="submit">[ Continue to Step 2 > ]</button>
        </form>
    </div>

</div>
</body>
</html>
